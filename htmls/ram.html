<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Divine Realm - Rama Avatar</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      overflow: hidden;
      font-family: 'Georgia', serif;
    }

    body {
      background: linear-gradient(180deg, 
        #ff6b35 0%, 
        #ff8c42 20%,
        #ffa500 40%, 
        #ffb84d 60%,
        #ffd700 80%,
        #ffe5b4 100%);
      position: relative;
    }

    #battleCanvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 5;
    }

    .divine-title {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      font-size: 80px;
      color: #ffd700;
      text-shadow: 
        0 0 30px rgba(255, 215, 0, 1),
        0 0 60px rgba(255, 140, 0, 0.8),
        3px 3px 10px rgba(0, 0, 0, 0.7);
      z-index: 11;
      font-weight: bold;
      pointer-events: none;
      opacity: 0;
      text-align: center;
    }

    .divine-title.show {
      animation: titleAppear 3s ease-out forwards;
    }

    @keyframes titleAppear {
      0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0) rotate(-45deg);
      }
      30% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1.3) rotate(5deg);
      }
      60% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1) rotate(-2deg);
      }
      100% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1.1) rotate(0deg);
      }
    }

    .shoot-button {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 12;
      padding: 20px 40px;
      font-size: 22px;
      background: linear-gradient(135deg, #ff4500 0%, #ff6347 100%);
      border: 3px solid #ffd700;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 5px 30px rgba(255, 69, 0, 0.6);
      transition: all 0.3s ease;
      font-weight: bold;
      color: white;
    }

    .shoot-button:hover {
      transform: translateX(-50%) translateY(-5px) scale(1.08);
      box-shadow: 0 10px 40px rgba(255, 69, 0, 0.9);
    }

    .shoot-button:active {
      transform: translateX(-50%) translateY(-2px) scale(1.02);
    }

    .audio-controls {
      position: fixed;
      top: 30px;
      right: 30px;
      z-index: 12;
      display: flex;
      gap: 10px;
      align-items: center;
      background: rgba(139, 69, 19, 0.7);
      padding: 10px 20px;
      border-radius: 25px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 165, 0, 0.3);
    }

    .audio-btn {
      background: none;
      border: none;
      color: #ffa500;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s ease;
      padding: 5px;
    }

    .audio-btn:hover {
      transform: scale(1.2);
      filter: drop-shadow(0 0 10px #ffa500);
    }

    .volume-slider {
      width: 80px;
      height: 4px;
      background: rgba(255, 165, 0, 0.3);
      border-radius: 2px;
      outline: none;
      -webkit-appearance: none;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 12px;
      height: 12px;
      background: #ffa500;
      border-radius: 50%;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .divine-title {
        font-size: 48px;
      }

      .shoot-button {
        font-size: 18px;
        padding: 15px 30px;
      }
    }
  </style>
</head>
<body>

  <!-- Canvas for entire battle scene -->
  <canvas id="battleCanvas"></canvas>

  <!-- Divine Title (appears after victory) -->
  <div class="divine-title" id="divineTitle">
    üèπ ‡§∂‡•ç‡§∞‡•Ä ‡§∞‡§æ‡§Æ ‡§Ö‡§µ‡§§‡§æ‡§∞ üèπ<br>
    <span style="font-size: 0.6em;">‡§ú‡§Ø ‡§∂‡•ç‡§∞‡•Ä ‡§∞‡§æ‡§Æ!</span>
  </div>

  <!-- Audio Controls -->
  <div class="audio-controls">
    <button class="audio-btn" id="playPauseBtn">‚ñ∂Ô∏è</button>
    <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50">
    <span class="audio-btn">üîä</span>
  </div>

  <!-- Shoot Button -->
  <button class="shoot-button" id="shootButton">üèπ SHOOT ARROW</button>

  <!-- Audio Elements -->
  <audio id="ramaAudio" loop>
    <source src="audio/rama-dhun.mp3" type="audio/mp3" />
  </audio>

  <audio id="arrowSound">
    <source src="audio/arrow-shoot.mp3" type="audio/mp3" />
  </audio>

  <audio id="victorySound">
    <source src="audio/victory.mp3" type="audio/mp3" />
  </audio>

  <script>
    const canvas = document.getElementById('battleCanvas');
    const ctx = canvas.getContext('2d');
    
    // Set canvas to full window size
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    
    window.addEventListener('resize', () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });

    const ramaAudio = document.getElementById("ramaAudio");
    const arrowSound = document.getElementById("arrowSound");
    const victorySound = document.getElementById("victorySound");
    const playPauseBtn = document.getElementById("playPauseBtn");
    const volumeSlider = document.getElementById("volumeSlider");
    const shootButton = document.getElementById("shootButton");
    const divineTitle = document.getElementById("divineTitle");

    let isPlaying = false;
    let isShooting = false;
    let animationFrame = 0;
    let arrowX = 0;
    let arrowY = 0;
    let arrowFlying = false;
    let bowPullback = 0;
    let ravanaVisible = true;
    let celebrationActive = false;
    let celebrationParticles = [];

    // Rama body part positions and angles
    let ramaX = canvas.width * 0.25;
    let ramaY = canvas.height * 0.5;
    let breathingOffset = 0;
    let leftArmAngle = -15;
    let rightArmAngle = 15;
    let leftLegAngle = 0;
    let rightLegAngle = 0;
    let bowAngle = -25;

    // Ravana body part positions and angles
    let ravanaX = canvas.width * 0.75;
    let ravanaY = canvas.height * 0.45;
    let ravanaBreathing = 0;
    let ravanaArmAngle = 0;
    let ravanaLegAngle = 0;
    let ravanaScale = 1;
    let ravanaRotation = 0;
    let ravanaOpacity = 1;

    ramaAudio.volume = 0.5;
    arrowSound.volume = 0.8;
    victorySound.volume = 0.7;

    // Celebration particle class
    class Particle {
      constructor(x, y) {
        this.x = x;
        this.y = y;
        this.vx = (Math.random() - 0.5) * 10;
        this.vy = (Math.random() - 0.5) * 10 - 5;
        this.life = 1;
        this.size = Math.random() * 8 + 4;
        this.color = ['#ffd700', '#ff6347', '#ff8c00', '#ffed4e'][Math.floor(Math.random() * 4)];
      }

      update() {
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.3; // gravity
        this.life -= 0.015;
      }

      draw() {
        ctx.save();
        ctx.globalAlpha = this.life;
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowColor = this.color;
        ctx.shadowBlur = 15;
        ctx.fill();
        ctx.restore();
      }
    }

    // Draw Rama character
    function drawRama() {
      const x = ramaX;
      const y = ramaY + breathingOffset;
      
      ctx.save();
      ctx.translate(x, y);

      // Left Leg
      ctx.save();
      ctx.translate(-30, 80);
      ctx.rotate((leftLegAngle * Math.PI) / 180);
      ctx.fillStyle = '#ff8c42';
      ctx.strokeStyle = '#8b0000';
      ctx.lineWidth = 3;
      ctx.fillRect(-15, 0, 30, 120);
      ctx.strokeRect(-15, 0, 30, 120);
      // Foot
      ctx.fillStyle = '#8b4513';
      ctx.fillRect(-20, 120, 40, 15);
      ctx.restore();
      
      // Right Leg
      ctx.save();
      ctx.translate(30, 80);
      ctx.rotate((rightLegAngle * Math.PI) / 180);
      ctx.fillStyle = '#ff8c42';
      ctx.strokeStyle = '#8b0000';
      ctx.lineWidth = 3;
      ctx.fillRect(-15, 0, 30, 120);
      ctx.strokeRect(-15, 0, 30, 120);
      // Foot
      ctx.fillStyle = '#8b4513';
      ctx.fillRect(-20, 120, 40, 15);
      ctx.restore();
      
      // Body (torso)
      ctx.fillStyle = '#ff6347';
      ctx.strokeStyle = '#8b0000';
      ctx.lineWidth = 3;
      ctx.fillRect(-50, -80, 100, 160);
      ctx.strokeRect(-50, -80, 100, 160);
      
      // Head
      ctx.save();
      ctx.translate(0, -100);
      ctx.fillStyle = '#ffdbac';
      ctx.strokeStyle = '#8b4513';
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.arc(0, 0, 40, 0, Math.PI * 2);
      ctx.fill();
      ctx.stroke();
      // Crown
      ctx.fillStyle = '#ffd700';
      ctx.fillRect(-35, -40, 70, 20);
      ctx.fillStyle = '#ff4500';
      ctx.font = 'bold 30px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('üëë', 0, -25);
      ctx.restore();
      
      // Left Arm (holding bow)
      ctx.save();
      ctx.translate(-60, -40);
      ctx.rotate((leftArmAngle * Math.PI) / 180);
      ctx.fillStyle = '#ffdbac';
      ctx.strokeStyle = '#8b4513';
      ctx.lineWidth = 3;
      ctx.fillRect(-15, 0, 30, 80);
      ctx.strokeRect(-15, 0, 30, 80);
      // Forearm
      ctx.save();
      ctx.translate(0, 80);
      ctx.rotate((bowPullback * 0.5 * Math.PI) / 180);
      ctx.fillRect(-12, 0, 24, 70);
      ctx.strokeRect(-12, 0, 24, 70);
      ctx.restore();
      ctx.restore();
      
      // Right Arm (pulling string)
      ctx.save();
      ctx.translate(60, -40);
      ctx.rotate((rightArmAngle * Math.PI) / 180);
      ctx.fillStyle = '#ffdbac';
      ctx.strokeStyle = '#8b4513';
      ctx.lineWidth = 3;
      ctx.fillRect(-15, 0, 30, 80);
      ctx.strokeRect(-15, 0, 30, 80);
      // Forearm
      ctx.save();
      ctx.translate(0, 80);
      ctx.rotate((-bowPullback * 0.7 * Math.PI) / 180);
      ctx.fillRect(-12, 0, 24, 70);
      ctx.strokeRect(-12, 0, 24, 70);
      ctx.restore();
      ctx.restore();

      ctx.restore();
      
      // Draw Bow (in front of Rama)
      if (!arrowFlying) {
        ctx.save();
        ctx.translate(x - 100 + bowPullback * 2, y);
        ctx.rotate((bowAngle * Math.PI) / 180);
        
        // Bow arc
        ctx.strokeStyle = '#8b4513';
        ctx.lineWidth = 8;
        ctx.beginPath();
        ctx.arc(0, 0, 80, -Math.PI / 2, Math.PI / 2, false);
        ctx.stroke();
        
        // Bow string
        ctx.strokeStyle = '#f0e68c';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(0, -80);
        ctx.lineTo(-bowPullback * 1.5, 0);
        ctx.lineTo(0, 80);
        ctx.stroke();
        
        // Arrow on bow
        ctx.strokeStyle = '#cd853f';
        ctx.lineWidth = 6;
        ctx.fillStyle = '#daa520';
        ctx.beginPath();
        ctx.moveTo(-bowPullback * 1.5, 0);
        ctx.lineTo(100, 0);
        ctx.stroke();
        
        // Arrow tip
        ctx.beginPath();
        ctx.moveTo(100, 0);
        ctx.lineTo(90, -8);
        ctx.lineTo(90, 8);
        ctx.closePath();
        ctx.fill();
        
        ctx.restore();
      }
    }

    // Draw Ravana character
    function drawRavana() {
      if (!ravanaVisible && ravanaOpacity <= 0) return;
      
      const x = ravanaX;
      const y = ravanaY + ravanaBreathing;
      
      ctx.save();
      ctx.globalAlpha = ravanaOpacity;
      ctx.translate(x, y);
      ctx.rotate(ravanaRotation);
      ctx.scale(ravanaScale, ravanaScale);

      // Left Leg
      ctx.save();
      ctx.translate(-35, 100);
      ctx.rotate((ravanaLegAngle * Math.PI) / 180);
      ctx.fillStyle = '#4a0e0e';
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 3;
      ctx.fillRect(-18, 0, 36, 130);
      ctx.strokeRect(-18, 0, 36, 130);
      ctx.restore();
      
      // Right Leg
      ctx.save();
      ctx.translate(35, 100);
      ctx.rotate((-ravanaLegAngle * Math.PI) / 180);
      ctx.fillStyle = '#4a0e0e';
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 3;
      ctx.fillRect(-18, 0, 36, 130);
      ctx.strokeRect(-18, 0, 36, 130);
      ctx.restore();
      
      // Body (larger torso)
      ctx.fillStyle = '#8b0000';
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 4;
      ctx.fillRect(-70, -100, 140, 200);
      ctx.strokeRect(-70, -100, 140, 200);
      
      // Multiple Heads (10 heads of Ravana)
      const headPositions = [
        {x: 0, y: -160},
        {x: -50, y: -140},
        {x: 50, y: -140},
        {x: -90, y: -120},
        {x: 90, y: -120},
        {x: -60, y: -100},
        {x: 60, y: -100},
        {x: -30, y: -120},
        {x: 30, y: -120},
        {x: 0, y: -180}
      ];
      
      headPositions.forEach(pos => {
        ctx.save();
        ctx.translate(pos.x, pos.y);
        ctx.fillStyle = '#654321';
        ctx.strokeStyle = '#000';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(0, 0, 25, 0, Math.PI * 2);
        ctx.fill();
        ctx.stroke();
        
        // Evil eyes
        ctx.fillStyle = '#ff0000';
        ctx.fillRect(-8, -5, 6, 6);
        ctx.fillRect(2, -5, 6, 6);
        ctx.restore();
      });
      
      // Left Arm
      ctx.save();
      ctx.translate(-80, -50);
      ctx.rotate((ravanaArmAngle * Math.PI) / 180);
      ctx.fillStyle = '#654321';
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 3;
      ctx.fillRect(-18, 0, 36, 90);
      ctx.strokeRect(-18, 0, 36, 90);
      ctx.save();
      ctx.translate(0, 90);
      ctx.fillRect(-15, 0, 30, 80);
      ctx.strokeRect(-15, 0, 30, 80);
      ctx.restore();
      ctx.restore();
      
      // Right Arm
      ctx.save();
      ctx.translate(80, -50);
      ctx.rotate((-ravanaArmAngle * Math.PI) / 180);
      ctx.fillStyle = '#654321';
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 3;
      ctx.fillRect(-18, 0, 36, 90);
      ctx.strokeRect(-18, 0, 36, 90);
      ctx.save();
      ctx.translate(0, 90);
      ctx.fillRect(-15, 0, 30, 80);
      ctx.strokeRect(-15, 0, 30, 80);
      ctx.restore();
      ctx.restore();

      ctx.restore();
    }

    // Draw flying arrow
    function drawArrow() {
      if (!arrowFlying) return;
      
      ctx.save();
      ctx.translate(arrowX, arrowY);
      ctx.rotate(-20 * Math.PI / 180);
      
      // Arrow shaft
      ctx.strokeStyle = '#cd853f';
      ctx.lineWidth = 8;
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.lineTo(120, 0);
      ctx.stroke();
      
      // Arrow tip
      ctx.fillStyle = '#daa520';
      ctx.beginPath();
      ctx.moveTo(120, 0);
      ctx.lineTo(105, -12);
      ctx.lineTo(105, 12);
      ctx.closePath();
      ctx.fill();
      
      // Glow effect
      ctx.shadowColor = 'rgba(255, 215, 0, 0.9)';
      ctx.shadowBlur = 25;
      ctx.stroke();
      
      // Trail
      ctx.strokeStyle = 'rgba(255, 215, 0, 0.5)';
      ctx.lineWidth = 4;
      ctx.beginPath();
      ctx.moveTo(-50, 0);
      ctx.lineTo(0, 0);
      ctx.stroke();
      
      ctx.restore();
    }

    // Animation loop
    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      animationFrame++;
      
      // Breathing animations
      breathingOffset = Math.sin(animationFrame * 0.05) * 5;
      ravanaBreathing = Math.sin(animationFrame * 0.04) * 6;
      
      // Idle animations
      if (!isShooting) {
        leftLegAngle = Math.sin(animationFrame * 0.03) * 2;
        rightLegAngle = -Math.sin(animationFrame * 0.03) * 2;
        leftArmAngle = Math.sin(animationFrame * 0.04) * 3 - 15;
        rightArmAngle = Math.sin(animationFrame * 0.04) * 3 + 15;
        
        ravanaLegAngle = Math.sin(animationFrame * 0.035) * 3;
        ravanaArmAngle = Math.sin(animationFrame * 0.045) * 5 + 10;
      }
      
      // Flying arrow
      if (arrowFlying) {
        arrowX += 20;
        arrowY -= 1;
        
        // Check if hit Ravana
        if (arrowX >= ravanaX - 100 && !celebrationActive) {
          startCelebration();
        }
        
        if (arrowX > canvas.width + 200) {
          arrowFlying = false;
        }
      }
      
      // Celebration particles
      if (celebrationActive) {
        celebrationParticles.forEach((particle, index) => {
          particle.update();
          particle.draw();
          if (particle.life <= 0) {
            celebrationParticles.splice(index, 1);
          }
        });
        
        // Add more particles
        if (celebrationParticles.length < 150) {
          for (let i = 0; i < 5; i++) {
            celebrationParticles.push(new Particle(
              ravanaX + (Math.random() - 0.5) * 200,
              ravanaY + (Math.random() - 0.5) * 200
            ));
          }
        }
      }
      
      drawRavana();
      drawRama();
      drawArrow();
      
      requestAnimationFrame(animate);
    }

    // Start celebration
    function startCelebration() {
      celebrationActive = true;
      ravanaVisible = false;
      
      // Ravana disappearing animation
      let disappearFrame = 0;
      const disappearInterval = setInterval(() => {
        disappearFrame++;
        ravanaScale = 1 + disappearFrame * 0.05;
        ravanaRotation = (disappearFrame * 10 * Math.PI) / 180;
        ravanaOpacity = 1 - disappearFrame * 0.05;
        
        if (disappearFrame >= 20) {
          clearInterval(disappearInterval);
          
          // Show victory title
          setTimeout(() => {
            divineTitle.classList.add('show');
            if (victorySound) {
              victorySound.currentTime = 0;
              victorySound.play();
            }
          }, 500);
          
          // Reset after 5 seconds
          setTimeout(() => {
            celebrationActive = false;
            celebrationParticles = [];
            ravanaVisible = true;
            ravanaScale = 1;
            ravanaRotation = 0;
            ravanaOpacity = 1;
            divineTitle.classList.remove('show');
            isShooting = false;
          }, 5000);
        }
      }, 50);
    }

    // Shoot arrow function
    function shootArrow() {
      if (isShooting) return;
      
      isShooting = true;
      let pullFrame = 0;
      
      // Pull back animation
      const pullInterval = setInterval(() => {
        pullFrame++;
        bowPullback = Math.min(pullFrame * 2.5, 50);
        leftArmAngle = -15 - pullFrame * 0.8;
        rightArmAngle = 15 + pullFrame * 1.2;
        
        if (pullFrame >= 20) {
          clearInterval(pullInterval);
          
          // Release arrow
          setTimeout(() => {
            arrowX = ramaX - 50;
            arrowY = ramaY;
            arrowFlying = true;
            bowPullback = 0;
            leftArmAngle = -15;
            rightArmAngle = 15;
            
            arrowSound.currentTime = 0;
            arrowSound.play();
            
          }, 300);
        }
      }, 50);
    }

    animate();

    shootButton.addEventListener("click", shootArrow);

    // Audio controls
    playPauseBtn.addEventListener("click", () => {
      if (isPlaying) {
        ramaAudio.pause();
        playPauseBtn.textContent = "‚ñ∂Ô∏è";
      } else {
        ramaAudio.play().catch(err => console.log("Playback error:", err));
        playPauseBtn.textContent = "‚è∏Ô∏è";
      }
      isPlaying = !isPlaying;
    });

    volumeSlider.addEventListener("input", (e) => {
      ramaAudio.volume = e.target.value / 100;
    });

    document.body.addEventListener("click", () => {
      if (!isPlaying) {
        ramaAudio.play().then(() => {
          isPlaying = true;
          playPauseBtn.textContent = "‚è∏Ô∏è";
        }).catch(err => console.log("Autoplay blocked:", err));
      }
    }, { once: true });

    setInterval(shootArrow, 10000);
  </script>

</body>
</html>